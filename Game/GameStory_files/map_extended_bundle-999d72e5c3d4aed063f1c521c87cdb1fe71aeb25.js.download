webpackJsonp([171],{"+X7E":function(e,t,n){var s=n("ZluR");"string"==typeof s&&(s=[[e.i,s,""]]);var i={hmr:!0};i.transform=void 0,i.insertInto=void 0;n("0tV6")(s,i);s.locals&&(e.exports=s.locals)},BS4b:function(e,t,n){"use strict";(function(e){var s=n("gcQM"),i=function(t){var n=t.messages,i=t.height,o=t.resendMessage;return e.createElement("div",{className:"pt-16 h-flex-column"},n.map(function(t,n){return e.createElement(s.a,{key:n,message:t,height:i,resendMessage:o})}))};t.a=i}).call(t,n("ccIB"))},CgDZ:function(e,t,n){function s(e){var t=i[e];return t?Promise.all(t.slice(1).map(n.e)).then(function(){return n(t[0])}):Promise.reject(new Error("Cannot find module '"+e+"'."))}var i={"./app":["hqmG"],"./app.js":["hqmG"],"./canvas/canvas":["gp2O",76],"./canvas/canvas.js":["gp2O",76],"./canvas/contextMenu":["1M8a",161],"./canvas/contextMenu.js":["1M8a",161],"./canvas/copyPaste":["d407"],"./canvas/copyPaste.js":["d407"],"./canvas/layout":["TEdV",125],"./canvas/layout.js":["TEdV",125],"./canvas/mapView":["Rq/x",77],"./canvas/mapView.js":["Rq/x",77],"./canvas/views/block":["cQwG",94],"./canvas/views/block.js":["cQwG",94],"./canvas/views/draggable":["wQol",160],"./canvas/views/draggable.js":["wQol",160],"./canvas/views/editable":["2UzH",105],"./canvas/views/editable.js":["2UzH",105],"./canvas/views/editableBlock":["fGk7",159],"./canvas/views/editableBlock.js":["fGk7",159],"./canvas/views/graphics":["t8zp"],"./canvas/views/graphics.js":["t8zp"],"./canvas/views/imageBlock":["7RHa"],"./canvas/views/imageBlock.js":["7RHa"],"./canvas/views/resizable":["2J63",158],"./canvas/views/resizable.js":["2J63",158],"./canvas/views/selectable":["tCwE",157],"./canvas/views/selectable.js":["tCwE",157],"./canvas/views/vboundary":["7DNH"],"./canvas/views/vboundary.js":["7DNH"],"./canvas/views/vconnection":["xAzy",75],"./canvas/views/vconnection.js":["xAzy",75],"./canvas/views/vconnectionEditor":["vxEF",156],"./canvas/views/vconnectionEditor.js":["vxEF",156],"./canvas/views/vconnectionHandler":["VQwZ",75],"./canvas/views/vconnectionHandler.js":["VQwZ",75],"./canvas/views/vgenericNode":["Vw2l",74],"./canvas/views/vgenericNode.js":["Vw2l",74],"./canvas/views/vnode":["NCMo",74],"./canvas/views/vnode.js":["NCMo",74],"./canvas/views/vnodeIcon":["UeFO",155],"./canvas/views/vnodeIcon.js":["UeFO",155],"./canvas/views/vnodeImage":["HM34"],"./canvas/views/vnodeImage.js":["HM34"],"./canvas/views/vnodeVideo":["Qy9x",154],"./canvas/views/vnodeVideo.js":["Qy9x",154],"./canvas/views/vroot":["Wp5U",84],"./canvas/views/vroot.js":["Wp5U",84],"./canvas/views/vrootChild":["rX76",153],"./canvas/views/vrootChild.js":["rX76",153],"./mm/plugins/wundermap":["boRQ",71],"./mm/plugins/wundermap.js":["boRQ",71],"./models/attachment":["j1ii",152],"./models/attachment.js":["j1ii",152],"./models/boundary":["qlsV"],"./models/boundary.js":["qlsV"],"./models/boundaryStyle":["xfYt"],"./models/boundaryStyle.js":["xfYt"],"./models/buffer":["1cfn"],"./models/buffer.js":["1cfn"],"./models/change":["TKta",81],"./models/change.js":["TKta",81],"./models/chatModel":["9Oqg"],"./models/chatModel.js":["9Oqg"],"./models/connectionModel":["/dW8",99],"./models/connectionModel.js":["/dW8",99],"./models/font":["6bYh"],"./models/font.js":["6bYh"],"./models/iconModel":["q3Rn",151],"./models/iconModel.js":["q3Rn",151],"./models/ideaComment":["ZfKP",150],"./models/ideaComment.js":["ZfKP",150],"./models/ideaImage":["oMUV",149],"./models/ideaImage.js":["oMUV",149],"./models/ideaProperty":["3Kh2",148],"./models/ideaProperty.js":["3Kh2",148],"./models/ideaVideo":["Kh9o",147],"./models/ideaVideo.js":["Kh9o",147],"./models/ideaVote":["00kP"],"./models/ideaVote.js":["00kP"],"./models/mapTheme":["r+xB"],"./models/mapTheme.js":["r+xB"],"./models/node":["HqoD",86],"./models/node.js":["HqoD",86],"./models/poller":["ahzF",146],"./models/poller.js":["ahzF",146],"./models/server":["jmxU",124],"./models/server.js":["jmxU",124],"./models/style":["FKf5"],"./models/style.js":["FKf5"],"./models/task":["AGfX",145],"./models/task.js":["AGfX",145],"./models/tree":["fSlT",85],"./models/tree.js":["fSlT",85],"./models/userModel":["gz1n"],"./models/userModel.js":["gz1n"],"./ui/attachmentViewer/view":["jMx0",106],"./ui/attachmentViewer/view.js":["jMx0",106],"./ui/boundaries":["1umx",69],"./ui/boundaries.js":["1umx",69],"./ui/customizeBoundary":["1QqJ",102],"./ui/customizeBoundary.js":["1QqJ",102],"./ui/customizeStyle":["UObq",92],"./ui/customizeStyle.js":["UObq",92],"./ui/doodling":["rg7Z",113],"./ui/doodling.js":["rg7Z",113],"./ui/filter":["QHRq",80],"./ui/filter.js":["QHRq",80],"./ui/footer":["k1IG"],"./ui/footer.js":["k1IG"],"./ui/footerPublic":["geal",144],"./ui/footerPublic.js":["geal",144],"./ui/header":["WGdr",79],"./ui/header.js":["WGdr",79],"./ui/hints":["qNKU"],"./ui/hints.js":["qNKU"],"./ui/history/history":["tt9h",65],"./ui/history/history.js":["tt9h",65],"./ui/history/revisionsBrowser":["i9TI",73],"./ui/history/revisionsBrowser.js":["i9TI",73],"./ui/history/revisionsSlider":["Lggz",73],"./ui/history/revisionsSlider.js":["Lggz",73],"./ui/history/slider":["Dxm5",143],"./ui/history/slider.js":["Dxm5",143],"./ui/history/utils":["OgPf",73],"./ui/history/utils.js":["OgPf",73],"./ui/menu":["qlDW"],"./ui/menu.js":["qlDW"],"./ui/message":["62Jj",142],"./ui/message.js":["62Jj",142],"./ui/onboarding/hintsPopover":["Hnw4",83],"./ui/onboarding/hintsPopover.js":["Hnw4",83],"./ui/onboarding/progressPopover":["fGUG",123],"./ui/onboarding/progressPopover.js":["fGUG",123],"./ui/onboarding/tutorial":["FlJR",82],"./ui/onboarding/tutorial.js":["FlJR",82],"./ui/options":["4KFD"],"./ui/options.js":["4KFD"],"./ui/presentation/controls":["INsm",141],"./ui/presentation/controls.js":["INsm",141],"./ui/presentation/player":["izkM",140],"./ui/presentation/player.js":["izkM",140],"./ui/presentation/presentation":["yj88",114],"./ui/presentation/presentation.js":["yj88",114],"./ui/presentation/slideshow":["qQu+",96],"./ui/presentation/slideshow.js":["qQu+",96],"./ui/preview":["/t6o",89],"./ui/preview.js":["/t6o",89],"./ui/print/print":["7Qzd",139],"./ui/print/print.js":["7Qzd",139],"./ui/sidebar":["qmQO",78],"./ui/sidebar.js":["qmQO",78],"./ui/sidebar/attachmentsWidget":["iy3A",104],"./ui/sidebar/attachmentsWidget.js":["iy3A",104],"./ui/sidebar/boundariesWidget":["49TO",122],"./ui/sidebar/boundariesWidget.js":["49TO",122],"./ui/sidebar/colorsWidget":["zDP6",112],"./ui/sidebar/colorsWidget.js":["zDP6",112],"./ui/sidebar/commentsWidget":["L/YL",115],"./ui/sidebar/commentsWidget.js":["L/YL",115],"./ui/sidebar/formatWidget":["6B3d",111],"./ui/sidebar/formatWidget.js":["6B3d",111],"./ui/sidebar/iconsWidget":["3sJ7",91],"./ui/sidebar/iconsWidget.js":["3sJ7",91],"./ui/sidebar/iconsWidgetExpanded/icon":["PlM2",138],"./ui/sidebar/iconsWidgetExpanded/icon.js":["PlM2",138],"./ui/sidebar/iconsWidgetExpanded/iconLibrary":["j0/H",121],"./ui/sidebar/iconsWidgetExpanded/iconLibrary.js":["j0/H",121],"./ui/sidebar/iconsWidgetExpanded/iconsWidgetExpanded":["ugn0",97],"./ui/sidebar/iconsWidgetExpanded/iconsWidgetExpanded.js":["ugn0",97],"./ui/sidebar/imagesWidget":["ZjT+",87],"./ui/sidebar/imagesWidget.js":["ZjT+",87],"./ui/sidebar/linksWidget":["079/",110],"./ui/sidebar/linksWidget.js":["079/",110],"./ui/sidebar/notesWidget":["G8SJ",109],"./ui/sidebar/notesWidget.js":["G8SJ",109],"./ui/sidebar/stylesWidget":["YQ4/",120],"./ui/sidebar/stylesWidget.js":["YQ4/",120],"./ui/sidebar/tabbedWidgetContainer":["twRW",119],"./ui/sidebar/tabbedWidgetContainer.js":["twRW",119],"./ui/sidebar/tasksWidget":["UWmw",103],"./ui/sidebar/tasksWidget.js":["UWmw",103],"./ui/sidebar/videosWidget":["cdGT",88],"./ui/sidebar/videosWidget.js":["cdGT",88],"./ui/sidebar/widget":["A9ap",137],"./ui/sidebar/widget.js":["A9ap",137],"./ui/sidebarPublic":["6DjJ",136],"./ui/sidebarPublic.js":["6DjJ",136],"./ui/slide":["GgL9",135],"./ui/slide.js":["GgL9",135],"./ui/styles":["H+A+",67],"./ui/styles.js":["H+A+",67],"./ui/template/template":["BbRJ",70],"./ui/template/template.js":["BbRJ",70],"./ui/template/templatePopover":["FmvE",134],"./ui/template/templatePopover.js":["FmvE",134],"./ui/themes":["uiuD",66],"./ui/themes.js":["uiuD",66],"./ui/users":["ePfb",133],"./ui/users.js":["ePfb",133],"./ui/wheelScroll":["vQBY",108],"./ui/wheelScroll.js":["vQBY",108],"./ui/zoom":["sNkp",101],"./ui/zoom.js":["sNkp",101],"./utils/constants":["67vC"],"./utils/constants.js":["67vC"],"./utils/customEvents":["xUHV"],"./utils/customEvents.js":["xUHV"],"./utils/googleSearch":["vLs6",132],"./utils/googleSearch.js":["vLs6",132],"./utils/imageSearch":["aVfQ",95],"./utils/imageSearch.js":["aVfQ",95],"./utils/images":["+ptD",131],"./utils/images.js":["+ptD",131],"./utils/layouter":["oxsE",130],"./utils/layouter.js":["oxsE",130],"./utils/math":["3Ox4"],"./utils/math.js":["3Ox4"],"./utils/meistertask/helpers":["H1Wq",129],"./utils/meistertask/helpers.js":["H1Wq",129],"./utils/meistertask/meistertask":["MSez",93],"./utils/meistertask/meistertask.js":["MSez",93],"./utils/meistertask/meistertask_picker":["e4gE",128],"./utils/meistertask/meistertask_picker.js":["e4gE",128],"./utils/meistertask/project_creator":["r3wk",107],"./utils/meistertask/project_creator.js":["r3wk",107],"./utils/searchWrapper":["wvK4",127],"./utils/searchWrapper.js":["wvK4",127],"./utils/skoletube/attachments/attachments":["PXir",68],"./utils/skoletube/attachments/attachments.js":["PXir",68],"./utils/skoletube/attachments/search":["4B9/",118],"./utils/skoletube/attachments/search.js":["4B9/",118],"./utils/skoletube/attachments/searchWrapper":["WvAO",100],"./utils/skoletube/attachments/searchWrapper.js":["WvAO",100],"./utils/skoletube/images/search":["MQVt",117],"./utils/skoletube/images/search.js":["MQVt",117],"./utils/skoletube/mediaSearch":["Z6lC",126],"./utils/skoletube/mediaSearch.js":["Z6lC",126],"./utils/skoletube/skoletube":["TMGa",64],"./utils/skoletube/skoletube.js":["TMGa",64],"./utils/skoletube/videos/search":["i5N/",116],"./utils/skoletube/videos/search.js":["i5N/",116],"./utils/videoHelpers":["vu0f"],"./utils/videoHelpers.js":["vu0f"],"./utils/videoSearch":["HTWB",98],"./utils/videoSearch.js":["HTWB",98]};s.keys=function(){return Object.keys(i)},s.id="CgDZ",e.exports=s},DrJx:function(e,t,n){"use strict";(function(e){function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function r(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function a(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=n("yviC"),h=function(t){function n(e){var t;return i(this,n),t=a(this,u(n).call(this,e)),t.state={user:users.findByID(t.props.userId)},t}return c(n,t),r(n,[{key:"componentWillReceiveProps",value:function(e){this.setState({user:users.findByID(e.userId)})}},{key:"render",value:function(){var t="rad-100% justify-center h-flex-row p-r "+this.props.className,n=this.state.user.isOnline()?"s-24":"o-40 o-hover-100 s-24",s="".concat(this.state.user.isOnline()?" (online)":" (offline)");return this.props.enabled?(n+=" h-cp",s+=" - ".concat(I18n.t("js.click_to_send_message"))):n+=" h-cd",e.createElement("div",{className:t},this.props.unread>0?e.createElement("span",{className:"chat-alert"},this.props.unread):null,e.createElement(f.a,{user:this.state.user,className:n,tooltip:s}))}}]),n}(e.Component);h.defaultProps={className:""},t.a=h}).call(t,n("ccIB"))},"HJ+y":function(e,t,n){"use strict";(function(e){function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function r(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function a(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?u(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=n("DrJx"),h=n("aEw3"),d=n("worM"),m=n("bPcH"),b=n("Z8UF"),g=n("9Oqg"),v=function(t){function n(e){var t;return i(this,n),t=a(this,l(n).call(this,e)),e.users.each(function(e){App.subscribe(CustomEvents.CHAT_UPDATE+"_"+e.id,function(){t.forceUpdate()}),g.default.getOlderMessages(e.id)},0),t.state={activeChat:0},t.setActiveChat=t.setActiveChat.bind(u(t)),t.unsetActiveChat=t.unsetActiveChat.bind(u(t)),t}return c(n,t),r(n,[{key:"setActiveChat",value:function(e,t){e.preventDefault(),e.stopPropagation(),this.setState({activeChat:t}),g.default.markAsRead(t)}},{key:"unsetActiveChat",value:function(){this.setState({activeChat:null})}},{key:"componentWillReceiveProps",value:function(e){var t=this;this.props.users.each(function(e){App.unsubscribe(CustomEvents.CHAT_UPDATE+"_"+e.id,function(){t.forceUpdate()})},0),e.users.each(function(e){App.subscribe(CustomEvents.CHAT_UPDATE+"_"+e.id,function(){t.forceUpdate()})},0)}},{key:"componentWillUnmount",value:function(){var e=this;this.props.users.each(function(t){App.unsubscribe(CustomEvents.CHAT_UPDATE+"_"+t.id,function(){e.forceUpdate()})},0)}},{key:"renderNotification",value:function(){var t=this.props.users.reduce(function(e,t){return e+g.default.getUnreadMessages(t.id).length},0);return t>0?e.createElement("span",{className:"chat-alert"},t):null}},{key:"renderContent",value:function(){var t=this;if(this.state.activeChat){var n=g.default.getChat(this.state.activeChat);return e.createElement(b.a,{messages:n.messages,userID:this.state.activeChat})}var s=this.props.users.map(function(n){var s=n.id,i=g.default.getUnreadMessages(s).length;return{icon:e.createElement(f.a,{className:"mr-8px",unread:i,userId:s,enabled:t.props.enabled}),label:n.name,className:"ellipsis",onClick:function(e){return t.setActiveChat(e,s)}}});return e.createElement(m.a,{inputClassName:"mh-15 mb-10",filterableAttribute:"label"},e.createElement(d.a,{items:s,closePopoverOnItemClick:!1,className:"minw-200px maxw-320px maxh-300px h-overflow-y"}))}},{key:"render",value:function(){return e.createElement(h.a,{position:"above",canAutoPosition:!1,className:"sections",opener:e.createElement("div",{className:"h-flex-row justify-center s-24 fs-10 b-1 rad-100% bc-grey3 c-grey-light mh-4px h-cp"},this.renderNotification(),"+"+this.props.users.length),onClose:this.unsetActiveChat},this.renderContent())}}]),n}(e.Component);t.a=v}).call(t,n("ccIB"))},QWVU:function(e,t,n){"use strict";(function(e){function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function r(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function a(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=n("BS4b"),h=n("atEJ"),d=n("ky7I"),m=function(t){function n(e){var t;return i(this,n),t=a(this,u(n).call(this,e)),t.height=0,t.stick=!0,t.stickToBottom=!0,t.state={loadingMessages:!0},t}return c(n,t),r(n,[{key:"componentDidMount",value:function(){this.wrapper.scrollTop=this.chat.offsetHeight,this.scrollToBottom(),this.setState({loadingMessages:!1})}},{key:"componentDidUpdate",value:function(){if(this.stick){if(this.height!==this.chat.offsetHeight&&!this.state.loadingMessages){var e=this.chat.offsetHeight-this.height;this.wrapper.scrollTop=e,this.stick=!1}}else this.stickToBottom&&(this.wrapper.scrollTop=this.chat.offsetHeight,this.stickToBottom=!1);this.height=this.chat.offsetHeight}},{key:"componentWillReceiveProps",value:function(){this.setState({loadingMessages:!1})}},{key:"scrollToBottom",value:function(){this.stickToBottom=!0}},{key:"render",value:function(){var t=this,n=this.props.loading?e.createElement(h.a,{size:24}):null;return e.createElement("div",{ref:function(e){return t.wrapper=e},className:"ph-5 bt-1 bb-1 bc-grey3  ph-12  h-overflow-y h-275"},e.createElement("div",{ref:function(e){return t.chat=e}},e.createElement(d.a,{onEnter:function(e){var n=e.previousPosition;e.currentPosition,e.event;null!==n&&"invisible"!==n&&(t.props.onScrollTop()?(t.stick=!0,t.setState({loadingMessages:!0})):t.setState({loadingMessages:!1}))}}),n,e.createElement(f.a,{resendMessage:this.props.resendMessage,messages:this.props.messages,height:275})))}}]),n}(e.Component);t.a=m}).call(t,n("ccIB"))},Z8UF:function(e,t,n){"use strict";(function(e){function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function r(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function a(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?u(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=n("yviC"),h=n("QWVU"),d=n("9Oqg"),m=function(t){function n(e){var t;return i(this,n),t=a(this,l(n).call(this,e)),t.markAsRead=t.markAsRead.bind(u(t)),t.onFocus=t.onFocus.bind(u(t)),t.keydown=t.keydown.bind(u(t)),t.onBlur=t.onBlur.bind(u(t)),t.submitMessage=t.submitMessage.bind(u(t)),t.resendMessage=t.resendMessage.bind(u(t)),t.update=t.update.bind(u(t)),t.fetchOlderMessages=t.fetchOlderMessages.bind(u(t)),t}return c(n,t),r(n,[{key:"markAsRead",value:function(){d.default.markAsRead(this.props.userID)}},{key:"onFocus",value:function(){this.keymap.enable()}},{key:"keydown",value:function(e){e.shiftKey||this.submitMessage(e.browserEvent)}},{key:"onBlur",value:function(){this.keymap.disable()}},{key:"submitMessage",value:function(e){Event.stop(e);var t=this.input.value;if(t.trim().length>0){var n={text:t,source:"me",user:users.selfUser,user_id:users.selfUser.id};this.input.value="",this.messages.scrollToBottom(),d.default.send(n,this.props.userID)}}},{key:"resendMessage",value:function(e){d.default.send(e,this.props.userID)}},{key:"update",value:function(){this.setState({chat:d.default.getChat(this.state.chat.targetId)})}},{key:"fetchOlderMessages",value:function(){return d.default.getOlderMessages(this.props.userID)}},{key:"onNewMessage",value:function(){this.messages.scrollToBottom()}},{key:"componentWillMount",value:function(){var e=MM.utils.KeyEvent;this.keymap=new MM.utils.KeyMap(document,"chat_keymap",[{key:[e.RETURN],fn:this.keydown,withEvent:!0,stopEvent:!1}]),this.keymap.disable()}},{key:"render",value:function(){var t=this,n=users.findByID(this.props.userID),s=d.default.getChat(this.props.userID).loading,i=n.isOnline()?"":"o-40",o=n.isOnline()?" (online)":" (offline)";return e.createElement("div",{onClick:this.markAsRead,className:"chat"},e.createElement("div",{className:"h-flex-row justify-sb ph-24 h-64"},e.createElement("div",{className:"h-flex-row h-flex-grow h-flex-shrink"},e.createElement(f.a,{user:n,className:i,tooltip:o}),e.createElement("span",{className:"fs-18 ml-13 ellipsis"},n.name.unescapeHTML()))),e.createElement(h.a,{ref:function(e){return t.messages=e},loading:s,resendMessage:this.resendMessage,onScrollTop:this.fetchOlderMessages,messages:this.props.messages}),e.createElement("div",{className:"is-stretched ph-24 h-84 bt-1"},e.createElement("form",{className:"h-100% h-flex-row justify-sb",onSubmit:this.submitMessage},e.createElement("textarea",{ref:function(e){return t.input=e},className:"content-visible h-100% h-flex-grow h-overflow-y lh-160% pr-20 pt-20 pb-10 b-0",placeholder:I18n.t("js.your_message"),maxLength:"255",autoFocus:!0,onFocus:this.onFocus,onBlur:this.onBlur}),e.createElement("input",{type:"submit",className:"button default",value:I18n.t("js.say_it")}))))}}]),n}(e.Component);t.a=m}).call(t,n("ccIB"))},ZluR:function(e,t,n){t=e.exports=n("Vmy+")(!1),t.push([e.i,'/* Chat Window Styles */\n/* Settings - imports, globals, colors */\n/* Grey Tones (Font Colors) */\n/* default font-color */\n/* border-color; placeholder-color; separator */\n/* Other Colors */\n/* used for selected items with light blue bg*/\n/* Global Settings */\n/* Font Sizes */\n/* Font Colors */\n/* Font Weights */\n/* Sketch: Black */\n/* Sketch: Roman */\n/* Line Heights */\n/* Border Colors */\n/* Border Radii */\n/* Box Shadows */\n/* Tools - mixins, global helpers */\n/* smaller than iPhone 6 screen - 375px*/\n/* Transitions and Animations */\n/* BLOCK LISTING */\n/* Other */\n/* hyphenation lets firefox use word-break: break-all */\n/* on retina  */\n/* standard popover arrow - color can be customized in subclasses */\n/* smaller than iPhone 6 screen - 375px*/\n.chat {\n  width: 320px;\n  overflow: hidden; }\n  .chat .bubble {\n    word-wrap: break-word;\n    max-width: 250px;\n    position: relative;\n    padding: 5px 15px;\n    border-radius: 15px;\n    margin-bottom: 5px;\n    display: inline-block; }\n    .chat .bubble p {\n      word-break: break-word; }\n      .chat .bubble p a {\n        text-decoration: underline; }\n    .chat .bubble img {\n      width: 20px;\n      height: 20px;\n      display: inline-block;\n      vertical-align: text-bottom; }\n  .chat .from-me {\n    align-self: flex-end; }\n    .chat .from-me .bubble {\n      color: white;\n      background: #00AAFF; }\n      .chat .from-me .bubble:before {\n        content: "";\n        position: absolute;\n        z-index: -1;\n        bottom: -2px;\n        right: -5px;\n        height: 15px;\n        width: 20px;\n        background-color: #00AAFF;\n        border-bottom-left-radius: 15px; }\n      .chat .from-me .bubble:after {\n        content: "";\n        position: absolute;\n        z-index: 1;\n        bottom: -4px;\n        right: -56px;\n        width: 26px;\n        height: 15px;\n        background: white;\n        border-bottom-left-radius: 5px;\n        -webkit-transform: translate(-30px, -2px);\n                transform: translate(-30px, -2px); }\n      .chat .from-me .bubble a {\n        color: white; }\n  .chat .from-them .bubble {\n    color: #3D474D;\n    background: #F7F9FA; }\n    .chat .from-them .bubble:before {\n      content: "";\n      position: absolute;\n      z-index: 2;\n      bottom: -2px;\n      left: -7px;\n      height: 15px;\n      width: 20px;\n      background-color: #F7F9FA;\n      border-bottom-right-radius: 15px; }\n    .chat .from-them .bubble:after {\n      content: "";\n      position: absolute;\n      z-index: 3;\n      bottom: -2px;\n      left: -26px;\n      width: 26px;\n      height: 15px;\n      background: white;\n      border-bottom-right-radius: 5px; }\n\n#chat_messages img {\n  width: 24px;\n  height: 24px;\n  display: inline-block; }\n',""])},aYvJ:function(e,t,n){"use strict";(function(e){function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function r(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function a(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?u(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",function(){return d});var f=n("HJ+y"),h=n("jRmw"),d=function(t){function n(e){var t;return i(this,n),t=a(this,l(n).call(this,e)),t._openDialog=t._openDialog.bind(u(t)),t}return c(n,t),r(n,[{key:"sortUsers",value:function(e){return e.sort(function(e,t){return e.isOnline()===t.isOnline()?0:e.isOnline()?-1:1})}},{key:"usersExcludingSelfAndAnonymus",value:function(e){var t=this;return e.filter(function(e){return e.id!==t.props.selfUser.id&&(!e.anonymous||e.isOnline())})}},{key:"_openDialog",value:function(){if(!this.props.selfUser.anonymous)return MM.ui.dialogs.dialogSharing(this.props.mapId);MM.ui.dialogs.dialogLogin(this.props.selfUser)}},{key:"render",value:function(){var t=this.props,n=t.users,s=t.currentUsers,i=t.selfUser,o=t.visibleUsersCount,r=t.renderLink,a=this.usersExcludingSelfAndAnonymus(n),l=this.usersExcludingSelfAndAnonymus(s);if(0===a.length&&0===l.length)return null;var u=this.sortUsers(a),c=u.slice(0,o),p=!i.anonymous||2===i.permission,d=r?{onClick:this._openDialog,className:"c-blue td-underline h-cp lh-120%"}:{};return e.createElement("div",{className:"h-flex-row"},e.createElement("div",{className:"h-flex-column mr-10"},e.createElement("span",{className:"fs-10 c-lighter"},I18n.t("js.shared_with")),e.createElement("span",d,I18n.t("js.count_people",{count:a.length}))),e.createElement("div",{className:"h-flex-row mr-10"},c.map(function(t,n){return e.createElement(h.a,{key:t.id,userID:t.id,enabled:p})}),u.length>c.length?e.createElement(f.a,{users:u.slice(c.length,u.length),enabled:p}):null))}}]),n}(e.Component)}).call(t,n("ccIB"))},fti0:function(e,t,n){"use strict";(function(e){function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},s=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),s.forEach(function(t){o(e,t,n[t])})}return e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){if(null==e)return{};var n,s,i=a(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function a(e,t){if(null==e)return{};var n,s,i={},o=Object.keys(e);for(s=0;s<o.length;s++)n=o[s],t.indexOf(n)>=0||(i[n]=e[n]);return i}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function c(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}function p(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?f(e):t}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",function(){return A});var b=n("YmTu"),g=n("SO8C"),v=n("uJpZ"),y=n("worM"),w=n("jR5l"),j=n("aEw3"),k=n("xY9N"),_=["Facebook","Twitter","Pinterest"],E=function(){return null},O=function(e){var t=e.platform,n=e.isPublicMap,s=e.mapId,i=e.onPublish;if(n)M(t);else{var o;MM.ui.dialogs.dialogPublishConfirmation(s,{okCallback:function(){return o=M(t,!0)},successCallback:function(){i(),o.win.location.href=o.shareUrl}})}},M=function(e,t){var n=tree.root.getRawTitle(),s=App.tree.root.id;return MM.utils.Social.share(e,{async:t,rootId:s,title:n,url:"".concat(document.location.origin,"/").concat(s,"/").concat(App.titleToURI(n))})},S=function(t){var n=t.isPublicMap,s=t.canShare,i=t.mapId,o=t.onPublish;if(n||s){var r=_.map(function(t){return{icon:e.createElement(b.a,{opts:{name:"service-"+t.toLowerCase(),size:20,parentClasses:"rad-5px mr-8px"}}),label:t,onClick:function(){return O({platform:t,isPublicMap:n,mapId:i,onPublish:o})}}});return e.createElement(y.a,{header:{title:I18n.t("js.social_media")},items:r,className:"mt-10 mb-15"})}return e.createElement("div",null)},P=function(t){var n=t.isPublicMap,s=t.isPublishMapAllowed,i=t.isAnonymous,o=t.mapId,r=t.onPublish;if(!i){var a=[];if(s){var l=n?I18n.t("js.publishing_settings"):I18n.t("js.publish_map"),u={icon:e.createElement(b.a,{opts:{name:"publish",color:"white",size:12,consize:20,parentClasses:"bg-blue rad-5px mr-8px"}}),label:"".concat(l,"..."),onClick:function(){n?MM.ui.dialogs.dialogPublish(o):MM.ui.dialogs.dialogPublishConfirmation(o,{successCallback:function(){r(),MM.ui.dialogs.dialogPublish(o)}})}};a.push(u)}return a.push({icon:e.createElement(b.a,{opts:{name:"sharing",color:"white",size:12,consize:20,parentClasses:"bg-green rad-5px mr-8px"}}),label:I18n.t("js.sharing_settings")+"...",onClick:function(){return MM.ui.dialogs.dialogSharing(o)}}),e.createElement(y.a,{header:{title:I18n.t("js.more")},items:a,className:"mv-10"})}return e.createElement("div",null)},x=function(t){var n=t.currentUser,s=t.isPublicMap,i=t.mapId,o=t.onPublish,r=t.isLinkShareAllowed,a=t.isPublishMapAllowed,l=n.canShare(),u=n.anonymous||!l;return e.createElement("div",null,e.createElement("div",{className:"fs-18 fw-500 m-20px mt-10px"},I18n.t("js.share_this_map")),u?null:e.createElement(v.a,{title:I18n.t("js.invite_people"),hideTokenizerHeader:!0}),r?e.createElement(g.a,{className:"mb-20",readOnly:u,mapId:i,on:App.config.linkShare,link:App.config.shareLink,onChange:u?E:App.changeLinkSharing.bind(App)}):null,e.createElement(w.a,null,S({isPublicMap:s,canShare:l,mapId:i,onPublish:o}),P({isPublicMap:s,isPublishMapAllowed:a&&l,isAnonymous:n.anonymous,mapId:i,onPublish:o})))},A=function(t){function n(e){var t;return l(this,n),t=p(this,h(n).call(this,e)),t.state={isLinkShareAllowed:!0,isPublishMapAllowed:!0},t}return d(n,t),c(n,[{key:"componentWillMount",value:function(){var e=this;Object(k.b)(function(){return e.setState({isLinkShareAllowed:Object(k.c)(k.a.ALLOW_LINK_SHARE),isPublishMapAllowed:Object(k.c)(k.a.ALLOW_PUBLISH)})})}},{key:"render",value:function(){var t=this.props,n=t.onShow,s=t.onClose,o=r(t,["onShow","onClose"]);return e.createElement(j.a,{position:"above",canAutoPosition:!1,className:"sections",opener:e.createElement("button",{id:"btn_share",className:"h-flex-row h-32px lh-32px"},e.createElement("span",null,I18n.t("js.share")),e.createElement(b.a,{className:"c-blue pl-5px",opts:{name:"triangle",color:"blue",size:8}})),onShow:n,onClose:s},x(i({},o,this.state)))}}]),n}(e.Component)}).call(t,n("ccIB"))},gcQM:function(e,t,n){"use strict";(function(e){var s=n("YmTu"),i=function(t){var n,i=t.message,o=t.resendMessage,r=i.text.strip().escapeHTML().replace(/\n/gi,"<br/>"),a=(i.timestamp?new Date(1e3*i.timestamp):new Date).toUIString(),l=i.user_id!==users.selfUser.id?"them":"me";return i.failed&&(n=e.createElement("div",{className:"ta-center mv-10"},e.createElement(s.a,{className:"mb-5 h-iblock",opts:{name:"warning",size:30}}),e.createElement("span",{className:"h-block mb-10"},"Message could not be sent"),e.createElement("a",{onClick:function(){return o(i)},className:"button h-iblock mb-10"},"Resend"))),e.createElement("div",{className:"msg from-"+l},e.createElement("div",{className:"bubble",title:a},e.createElement("p",{dangerouslySetInnerHTML:{__html:EmojiArea.getHTMLContent(r)}}),n))};t.a=i}).call(t,n("ccIB"))},jRmw:function(e,t,n){"use strict";(function(e){function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function r(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function a(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?u(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=n("+X7E"),h=(n.n(f),n("Z8UF")),d=n("aEw3"),m=n("DrJx"),b=n("9Oqg"),g=function(t){function n(e){var t;return i(this,n),t=a(this,l(n).call(this,e)),b.default.getOlderMessages(t.props.userID),t.state={open:!1},t.markAsRead=t.markAsRead.bind(u(t)),t.setOpen=t.setOpen.bind(u(t)),t.setClosed=t.setClosed.bind(u(t)),t.update=t.update.bind(u(t)),t}return c(n,t),r(n,[{key:"markAsRead",value:function(){b.default.markAsRead(this.props.userID)}},{key:"setOpen",value:function(){this.setState({open:!0}),this.markAsRead()}},{key:"setClosed",value:function(){this.setState({open:!1})}},{key:"update",value:function(){b.default.getUnreadMessages(this.props.userID).length>0&&this.state.open&&(this.markAsRead(),this.widget.onNewMessage()),this.forceUpdate()}},{key:"componentDidMount",value:function(){App.subscribe(CustomEvents.CHAT_UPDATE+"_"+this.props.userID,this.update)}},{key:"componentWillReceiveProps",value:function(e){this.props.userID!==e.userID&&(b.default.getOlderMessages(e.userID),App.unsubscribe(CustomEvents.CHAT_UPDATE+"_"+this.props.userID,this.update),App.subscribe(CustomEvents.CHAT_UPDATE+"_"+e.userID,this.update))}},{key:"componentWillUnmount",value:function(){App.unsubscribe(CustomEvents.CHAT_UPDATE+"_"+this.props.userID,this.update),b.default.getOlderMessages(this.props.userID)}},{key:"render",value:function(){var t=this,n=b.default.getChat(this.props.userID),s=b.default.getUnreadMessages(this.props.userID).length;return e.createElement(d.a,{position:"above",canAutoPosition:!1,className:"p-0",onShow:this.setOpen,onClose:this.setClosed,disabled:!this.props.enabled,opener:e.createElement(m.a,{unread:s,userId:this.props.userID,className:"mh-4",enabled:this.props.enabled})},e.createElement(h.a,{ref:function(e){return t.widget=e},messages:n.messages,userID:this.props.userID}))}}]),n}(e.Component);t.a=g}).call(t,n("ccIB"))},k1IG:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,s){var i=(n("67vC"),n("aYvJ")),o=n("YmTu"),r=n("fti0"),a=n("8RG9"),l=n.n(a),u={visibleUsers:0,bars:{history:{height:168,permissions:"write",path:"ui/history/history"},slideshow:{height:150,permissions:"write",path:"ui/presentation/slideshow"},print:{height:77,permissions:"read",path:"ui/print/print"},meistertask:{height:150,permissions:"write",path:"utils/meistertask/meistertask"}},init:function(){this.el=$("map_footer"),this.els={bar:$("footerbar"),collaborators:$("collaborators-list"),collaboratorsContainer:$("collaboration-container")},this.enable(),Element.bindOnClick("btn_present",Presentation.togglePresenter.bind(Presentation)),Element.bindOnClick("btn_export",this._onExportClick.bind(this)),this.setViewportOffset(),UI.Registry.add(this),UI.Registry.notify(this,"show"),MM.ui.ToolTips.touchSafe({el:this.el}),this.els.collaborators&&this.els.collaboratorsContainer&&this._renderSharingButton(),this.calculateVisibleUsers(),App.subscribe(CustomEvents.COLLABORATORS_UPDATED,this._renderUsers.bind(this))},_onExportClick:function(){users.selfUser.anonymous?MM.ui.dialogs.dialogLogin(users.selfUser):MM.ui.dialogs.dialogExportMap(App.config.map_id,null,{onShow:function(){return App.trigger(CustomEvents.EXPORT_DLG_OPENED)},onClose:function(){return App.trigger(CustomEvents.EXPORT_DLG_CLOSED)}})},_onPrintClick:function(){users.selfUser.anonymous?MM.ui.dialogs.dialogLogin(users.selfUser):this.toggleBar("print")},_renderSharingButton:function(){var t=this;e.render(s.createElement(r.a,{currentUser:users.selfUser,mapId:App.config.map_id,isPublicMap:App.config.isPublic,onShow:function(){return App.trigger(CustomEvents.SHARING_POPOVER_OPENED)},onClose:function(){return App.trigger(CustomEvents.SHARING_POPOVER_CLOSED)},onPublish:function(){App.config.isPublic=!0,t._renderSharingButton()}}),mm$("btn-share-container"))},_renderUsers:function(){if("phantomjs"!==App.config.environment&&this.els.collaborators)if(MM.ua.isPhone||MM.ua.isTablet)e.render(s.createElement("div",{className:"h-flex-row p-r mr-10"},s.createElement(o.a,{opts:{name:"service-android",size:32,parentClasses:"rad-100%"}}),s.createElement(o.a,{opts:{name:"service-ios",size:32,parentClasses:"rad-100% bc-grey3 b-1 p-a h-v-center al-24"}}),s.createElement("p",{className:"fs-12 pl-30",dangerouslySetInnerHTML:{__html:I18n.t("js.app_teaser_map_view_html")}})),this.els.collaborators);else{var t=users.collaborators();e.render(s.createElement(i.a,{mapId:App.config.map_id,renderLink:"embedded_full"!==App.config.viewMode,users:t,currentUsers:users.currentUsers,selfUser:users.selfUser,visibleUsersCount:Math.min(this.visibleUsers,t.length)}),this.els.collaborators)}},setViewportOffset:function(){this.viewportSpace={bottom:this.el.offsetHeight+(this.activeBar?this.els.bar.offsetHeight:0)}},calculateVisibleUsers:function(){if(this.els.collaboratorsContainer){var e=this.els.collaboratorsContainer.clientWidth-280,t=Math.floor(e/32);this.visibleUsers=Math.min(t,5)}},onResize:function(){this.setViewportOffset();var e=this.visibleUsers;this.calculateVisibleUsers(),this.visibleUsers!==e&&this._renderUsers()},show:function(e){var t=this,n=(e?500:0)+"ms";CSS.set(this.el,{bottom:"0px",transitionDuration:n}),this.hiddenBar&&(this.showBar(this.hiddenBar),this.hiddenBar=null),setTimeout(function(){return UI.Registry.notify(t,"show")},e?500:10)},hide:function(e){var t=e?"500ms":"0ms";CSS.set(this.el,{bottom:-this.el.getHeight()+"px",transitionDuration:t}),this.activeBar&&(this.hiddenBar=this.activeBar,this.hideBar(this.activeBar)),UI.Registry.notify(this,"hide")},enable:function(){Object.keys(this.bars).each(function(e){var t=e+"Listener",n=$("btn_toggle"+e);if(!this.hasOwnProperty(t)){var s=this["_on"+l()(e)+"Click"];this[t]=s?s.bind(this):this.toggleBar.bind(this,e)}n&&("write"===this.bars[e].permissions&&App.config.editable||"read"===this.bars[e].permissions?(n.observe("click",this[t]),MM.ui.enableButton(n)):(n.stopObserving("click",this[t]),n.title=I18n.t("js.you_are_in_view_only_mode"),MM.ui.disableButton(n)))}.bind(this))},disable:function(){Object.keys(this.bars).each(function(e){mm$("btn_toggle"+e)&&$("btn_toggle"+e).stopObserving("click",this[e+"Listener"])}.bind(this))},toggleBar:function(e){return!!this.els.bar&&("write"!==this.bars[e].permissions||App.config.editable?(this.activeBar===e?this.hideBar(e):this.showBar(e),!1):(App.ui.Message.show(I18n.t("js.you_are_in_view_only_mode"),Message.NOTICE),!1))},showBar:function(e){if(this.els.bar){this.activeBar&&(this.hideBar(this.activeBar,!0),this.els.bar.innerHTML=""),this.actions.hasOwnProperty("onBeforeShow"+e.capitalize())&&this.actions["onBeforeShow"+e.capitalize()](),addClassName(mm$("btn_toggle"+e),"active");var t=function(){new Ajax.Request("/toolbar/"+e,{parameters:{id:App.config.map_id},evalScripts:!0,asynchronous:!0,onComplete:function(t){var n=t.responseJSON;n?(this.hideBar(e),removeClassName(mm$("btn_toggle"+e),"active"),MM.ui.enableButton("btn_toggle"+e),n.error?Message.show(n.error,Message.ERROR):n.info&&Message.show(n.info,Message.INFO)):("meistertask"===e&&this._prepareBar(e),this.activeBar&&this._doShowBar(e))}.bind(this)})}.bind(this),s=this.bars[e].path;n("CgDZ")("./".concat(s)).then(function(){return t()}),"meistertask"!==e&&(this._prepareBar(e),Amplitude.logEvent("toolbar_"+e)),App.hideAnonymousHint()}},_prepareBar:function(e){this.activeBar=e,this.els.bar.style.bottom="",this.els.bar.morph("height:"+this.bars[e].height+"px",{afterFinish:function(){UI.Registry.onResize(),this.onShowBarComplete(e),this.actions.hasOwnProperty("onShow"+e.capitalize())&&this.actions["onShow"+e.capitalize()]()}.bind(this)})},_doShowBar:function(e){this.actions.hasOwnProperty("doStart"+e.capitalize())?this.actions["doStart"+e.capitalize()]():this.enable(),MM.utils.siteLocation.setLoc(e),this.els.bar.select(".js-close-footerbar")[0].onclick=this.toggleBar.bind(this,e),MM.ui.enableButton("btn_toggle"+e)},onShowBarComplete:function(e){this.els.bar.addClassName("active"),"info"==e&&(this.els.bar.style.height="auto")},hideBar:function(e,t){this.els.bar&&(MM.utils.siteLocation.reset(),this.activeBar=null,removeClassName(this.els.bar,"active"),t?this._doHideBar(e):this.els.bar.morph("height: 0;",{afterFinish:this._doHideBar.bind(this,e)}),removeClassName(mm$("btn_toggle"+e),"active"),App.showAnonymousHint())},_doHideBar:function(e){this.els.bar.style.bottom="0",UI.Registry.onResize(),this.actions.hasOwnProperty("doStop"+e.capitalize())&&this.actions["doStop"+e.capitalize()](),new Ajax.Request("/toolbar/hide",{parameters:{id:App.config.map_id},evalScripts:!0,asynchronous:!0}),MM.ui.enableButton("btn_toggle"+e)}};u.Meistertask={updateIcon:function(e){var t=mm$("btn_togglemeistertask");t&&(e?(removeClassName(t,"icon-path"),addClassName(t,"icon-bg"),t.setAttribute("data-icon","mt-checkmark")):(removeClassName(t,"icon-bg"),addClassName(t,"icon-path"),t.setAttribute("data-icon","mt-checkmark-border")),MM.ui.svgIcons(t))}},u.actions={onBeforeShowPrint:function(){App.config.currentlyEditable=!1,UI.Registry.toggleMode("view")},doStartPrint:function(){App.ui.Print.init()},doStopPrint:function(){App.config.editable&&(App.config.currentlyEditable=!0,UI.Registry.toggleMode("edit")),App.ui.Print.exit()},doStartMeistertask:function(){App.trigger(CustomEvents.MEISTERTASK_BAR_OPENED)},doStopMeistertask:function(){MM.utils.Meistertask.exit();var e=GeneralPopover.get("mt_project_footer");e&&e.destroy()},onBeforeShowHistory:function(){App.config.showRevisions=!0,App.config.currentlyEditable=!1,UI.Registry.toggleMode("view"),App.showMapLoading()},doStartHistory:function(){RevisionBrowser.start(this.startHistoryView,!1,!0),App.trigger(CustomEvents.HISTORY_MODE_STARTED)},doStopHistory:function(){App.showMapLoading(),"undefined"!=typeof RevisionsSlider&&RevisionsSlider.highlightNodes(!1),"undefined"!=typeof RevisionBrowser&&RevisionBrowser.stop(),App.config.editable&&(App.config.currentlyEditable=!0,UI.Registry.toggleMode("edit")),mm$("canvas_container").style.opacity=1,App.config.showRevisions=!1,App.hideMapLoading(),App.trigger(CustomEvents.HISTORY_MODE_CLOSED)},doStartSlideshow:function(e){Presentation.Slideshow.prepare(e)},doStopSlideshow:function(){Presentation.on||Presentation.Slideshow.exit()},historyRevert:function(){var e=RevisionBrowser.revision+1;ServerConnection.historyRevert(e)},startHistoryView:function(){mm$("canvas_container").style.opacity=.7,App.hideMapLoading()}},t.default=u}.call(t,n("x9tB"),n("ccIB"))},sWsi:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(n("hqmG"),n("k1IG")),i=n("4KFD"),o=n("gz1n"),r=n("00kP"),a=(n.n(r),n("Bp4Y"));window.sideBar=null,App.ui.Footer=s.default,App.ui.Options=i.default,window.EmojiArea=a.a,window.User=o.UserModel,window.users=o.users},uJpZ:function(e,t,n){"use strict";(function(e){function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function r(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function a(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?u(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=n("fOgc"),h=n("zISO"),d=function(t){function n(e){var t;return i(this,n),t=a(this,l(n).call(this,e)),t.submit=t.submit.bind(u(t)),t}return c(n,t),r(n,[{key:"submit",value:function(e){var t=this;e.preventDefault(),e.stopPropagation();var n=this.widget.getMembers(),s=this.widget.getMembers("share_groups"),i=this.widget.getTokenCount();if(0!==i){var o=this.widget.isViewOnly();MM.ui.disableButton(this.submitButton),new Ajax.Request("/sharing/invite/"+App.config.map_id,{requestHeaders:{Accept:"application/json"},parameters:{collaborators:n,groups:s,send_invitations:!0,permission:o?1:2,message:""},onSuccess:function(e){var n=e.responseJSON;MM.ui.enableButton(t.submitButton),t.widget.clearTokens();var s=[],o=Message.INFO;n.errors&&(s=n.errors,o=Message.ERROR);var r=i-s.length;r>0&&s.push(I18n.t("js.invitations_sent",{count:r})),Message.show(s.join("<br />"),o),t.props.onSubmit()},onFailure:function(e){MM.ui.enableButton(t.submitButton),429===e.status?Message.show(I18n.t("js.error_on_invitations_rate_exceeded"),Message.ERROR):Message.show(I18n.t("js.error_on_invitations_try_again_later"),Message.ERROR)}})}}},{key:"render",value:function(){var t=this;return e.createElement("div",{className:"widget-container invitation-widget "+this.props.className},e.createElement(h.a,{title:this.props.title,className:"mt-10 mb-5"}),e.createElement("form",{className:"mb-20",onSubmit:this.submit},e.createElement("div",{className:"h-flex-start"},e.createElement(f.a,{ref:function(e){return t.widget=e},className:"w-200 mr-10",placeholder:I18n.t("js.email_or_name"),hideTokenizerHeader:this.props.hideTokenizerHeader}),e.createElement("input",{ref:function(e){return t.submitButton=e},type:"submit",className:"button default",value:I18n.t("js.invite")}))))}}]),n}(e.Component);d.defaultProps={className:"",onSubmit:function(){}},t.a=d}).call(t,n("ccIB"))},xY9N:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"c",function(){return r}),n.d(t,"b",function(){return a});var s={isFetched:!1,preferences:[]},i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return null};new Ajax.Request("/team_preferences.json",{method:"GET",onSuccess:function(t){s.isFetched=!0,s.preferences=t.responseJSON,e(s.preferences)}})},o={ALLOW_LINK_SHARE:"allow_link_share",ALLOW_PUBLISH:"allow_publish",ALLOW_ACTIVITY:"allow_activity"},r=function(e){var t=s.preferences.find(function(t){return t.name===e});return!t||"0"!==t.value},a=function(e){s.isFetched?e(s.preferences):i(e)}}},["sWsi"]);